#***********************************************************************
#* Meta Pre Processor, a language blender                              *
#* (c) 2013 by Philippe Wang <philippe.wang@cl.cam.ac.uk>              *
#* Licence : CeCILL-B                                                  *
#* http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.html         *
#***********************************************************************

MPP_MLs = mpp_charset.ml mpp_init.ml mpp_charstream.ml mpp_stringmap.ml mpp_variables.ml mpp_actions.ml mpp_core.ml mpp_libload.ml mpp_load.ml mpp_main.ml
MPP_CMOs = $(addsuffix .cmo, $(basename $(MPP_MLs)))
MPP_CMXs = $(addsuffix .cmx, $(basename $(MPP_MLs)))

# Default is the bytecode version because it takes less time to compile.
default:mpp

mpp:$(MPP_CMOs)
	ocamlc -g -o $@ $+

mpp.opt:$(MPP_CMXs)
	ocamlopt -g -o $@ $+


all:mpp mpp.out mpp-ocaml-toplevel-output

%.cmo:%.ml
	ocamlc -c $<

%.cmx:%.ml
	ocamlopt -c $<

clean:
	rm -f *.cm[oxi] mpp mpp.opt *~

# Part generated by ocamldep: 
include Makefile.depend

Makefile.depend:$(MPP_MLs)
	ocamldep $+ > $@

