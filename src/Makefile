#***********************************************************************
#* Meta Pre Processor, a language blender                              *
#* (c) 2013 by Philippe Wang <philippe.wang@cl.cam.ac.uk>              *
#* Licence : CeCILL-B                                                  *
#* http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.html         *
#***********************************************************************


# Default is the bytecode version because it takes less time to compile.
mpp:mpp_charset.cmo mpp_init.cmo mpp_charstream.cmo mpp_stringmap.cmo mpp_actions.cmo mpp_core.cmo mpp_libload.cmo mpp_load.cmo mpp_variables.cmo mpp_main.cmo
	ocamlc -g -o $@ $+

mpp.opt:mpp_charset.cmx mpp_init.cmx mpp_charstream.cmx mpp_stringmap.cmx mpp_actions.cmx mpp_core.cmx mpp_libload.cmx mpp_load.cmx mpp_variables.cmx mpp_main.cmx
	ocamlopt -g -o $@ $+


# This one is still very experimental:
mpp-ocaml-toplevel-output:mpp_charset.cmo mpp_init.cmo mpp_charstream.cmo mpp_ocaml_toplevel_error_formatting.cmo
	ocamlc -g -o $@ $+


all:mpp mpp.out

%.cmo:%.ml
	ocamlc -c $<

%.cmx:%.ml
	ocamlopt -c $<

clean:
	rm -f *.cm[oxi] mpp mpp.opt *~

# Part generated by ocamldep: 
mpp_actions.cmo : mpp_stringmap.cmo mpp_init.cmo mpp_charstream.cmo
mpp_actions.cmx : mpp_stringmap.cmx mpp_init.cmx mpp_charstream.cmx
mpp_charset.cmo :
mpp_charset.cmx :
mpp_charstream.cmo : mpp_init.cmo mpp_charset.cmo
mpp_charstream.cmx : mpp_init.cmx mpp_charset.cmx
mpp_core.cmo :
mpp_core.cmx :
mpp_init.cmo : mpp_charset.cmo
mpp_init.cmx : mpp_charset.cmx
mpp_libload.cmo :
mpp_libload.cmx :
mpp_load.cmo :
mpp_load.cmx :
mpp_main.cmo : mpp_stringmap.cmo mpp_init.cmo mpp_charstream.cmo \
    mpp_actions.cmo
mpp_main.cmx : mpp_stringmap.cmx mpp_init.cmx mpp_charstream.cmx \
    mpp_actions.cmx
mpp_stringmap.cmo :
mpp_stringmap.cmx :
mpp_variables.cmo : mpp_stringmap.cmo
mpp_variables.cmx : mpp_stringmap.cmx
